<Page x:Class="Uno.AzureDevOps.Views.Content.ProfilePage"
	  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	  xmlns:behaviors="using:Uno.AzureDevOps.Views.Behaviors"
	  xmlns:local="using:Uno.AzureDevOps.Views.Content"
	  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	  xmlns:toolkit="using:Uno.UI.Toolkit"
	  mc:Ignorable="">

	<Grid Background="{StaticResource Color07Brush}"
		  toolkit:VisibleBoundsPadding.PaddingMask="Left,Right">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<VisualStateManager.VisualStateGroups>
			<VisualStateGroup>

				<VisualState x:Name="wide">

					<VisualState.StateTriggers>
						<AdaptiveTrigger MinWindowWidth="1024" />
					</VisualState.StateTriggers>

					<VisualState.Setters>
						<Setter Target="LogOutButton.MaxWidth"
								Value="300" />
						<Setter Target="ReloadButton.MaxWidth"
								Value="300" />
						<Setter Target="RootGrid.Margin"
								Value="200,0" />
						<Setter Target="RootGrid.BorderThickness"
								Value="1,0" />
					</VisualState.Setters>
				</VisualState>
			</VisualStateGroup>
		</VisualStateManager.VisualStateGroups>

		<!-- CommandBar -->
		<CommandBar Content="Profile" />

		<ScrollViewer Grid.Row="1">
			
			<Grid x:Name="RootGrid"
				  Background="{StaticResource Color02Brush}">

				<!-- Loading State -->
				<Grid Visibility="{Binding UserProfile.IsExecuting, Converter={StaticResource TrueToVisible}, FallbackValue=Collapsed}">

					<StackPanel VerticalAlignment="Center"
								HorizontalAlignment="Center">

						<!-- Progress Ring -->
						<ProgressRing IsActive="True"
									  Foreground="{StaticResource Color03Brush}"
									  Height="20"
									  Width="20"
									  HorizontalAlignment="Center"
									  VerticalAlignment="Center"
									  Margin="0,12" />

						<!-- Loading Message -->
						<TextBlock Text="Loading..."
								   Style="{StaticResource Typo11}" />
					</StackPanel>
				</Grid>

				<!-- Error State -->
				<Grid Visibility="{Binding UserProfile.IsFaulted, Converter={StaticResource TrueToVisible}, FallbackValue=Collapsed}">

					<!-- Message -->
					<TextBlock Text="{Binding UserProfile.IsInternetFaulted, Converter={StaticResource BoolToCustomString}}"
							   Style="{StaticResource Typo10}"
							   HorizontalAlignment="Center"
							   VerticalAlignment="Center"
							   TextAlignment="Center"
							   Margin="50,0,50,48" />

					<!-- Reload button -->
					<Button x:Name="ReloadButton"
							Content="Reload"
							Command="{Binding ReloadPage}"
							Style="{StaticResource ReloadButtonStyle}"
							VerticalAlignment="Bottom"
							Margin="16,22" />
				</Grid>

				<!-- Content -->
				<Grid Visibility="{Binding UserProfile.IsSuccess, Converter={StaticResource TrueToVisible}, FallbackValue=Visible}">

					<Grid x:Name="RootLayout">
						<Grid.RowDefinitions>
							<RowDefinition Height="*" />
							<RowDefinition Height="Auto" />
							<RowDefinition Height="Auto" />
						</Grid.RowDefinitions>

						<StackPanel>
							<Grid Height="60">
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="Auto" />
									<ColumnDefinition Width="*" />
								</Grid.ColumnDefinitions>

								<Grid Background="{StaticResource Color07Brush}"
									  CornerRadius="16"
									  Height="32"
									  Width="32"
									  Margin="16,0,0,0">

									<!-- Initials -->
									<TextBlock Text="{Binding UserProfile.Result.Name, Converter={StaticResource MemberInitials}}"
											   Style="{StaticResource MemberInitialsTextBlock}" />

									<!-- Image -->
									<Grid CornerRadius="16"
										  Height="32"
										  Width="32">
										<Grid.Background>
											<ImageBrush behaviors:ImageBrushStreamSourceBehavior.Source="{Binding UserProfile.Result.Image}" />
										</Grid.Background>
									</Grid>
								</Grid>

								<!-- Info -->
								<StackPanel Margin="11,12,16,0"
											VerticalAlignment="Top"
											Grid.Column="1">

									<!-- Name -->
									<TextBlock Text="{Binding UserProfile.Result.Name}"
											   Style="{StaticResource Typo08}"
											   TextWrapping="NoWrap" />

									<!-- Email -->
									<TextBlock Text="{Binding UserProfile.Result.Email}"
											   Style="{StaticResource Typo18}"
											   TextWrapping="NoWrap"
											   Margin="0,-2,0,0" />
								</StackPanel>
							</Grid>

							<!-- Separator -->
							<Rectangle Fill="{StaticResource Color07Brush}"
									   Height="1" />

							<!-- About Us Button -->
							<Button Content="About Us"
									Command="{Binding ToAboutPage}"
									Style="{StaticResource ListItemButtonStyle}" />

							<!-- Terms & Conditions Button -->
							<Button Content="Terms and Conditions"
									Command="{Binding NavigateToTermsAndConditions}"
									Style="{StaticResource ListItemButtonStyle}" />

							<!-- Privacy Policy Button -->
							<Button Content="Privacy Policy"
									Command="{Binding NavigateToPrivacyPolicy}"
									Style="{StaticResource ListItemButtonStyle}" />
						</StackPanel>

						<!-- Source Code Info -->
						<StackPanel Grid.Row="1">

							<!-- Message -->
							<TextBlock Text="Source Code available on"
									   Style="{StaticResource Typo13}"
									   HorizontalAlignment="Center"
									   Margin="0,24,0,0"/>

							<!-- Hyperlink to source code -->
							<HyperlinkButton Content="GitHub"
											 HorizontalAlignment="Center"
											 Command="{Binding NavigateToSourceCode}" />

							<!-- Version Number -->
							<TextBlock Visibility="{Binding AppVersion, Converter={StaticResource EmptyStringToCollapsed}, FallbackValue=Collapsed}"
									   Style="{StaticResource Typo18}"
									   HorizontalAlignment="Center"
									   Margin="0,0,0,0">
								<Run Text="Version" />
								<Run Text="{Binding AppVersion}" />
							</TextBlock>
						</StackPanel>

						<!-- Log out button -->
						<Button x:Name="LogOutButton"
								Content="Log Out"
								Style="{StaticResource PrimaryButtonStyle}"
								Command="{Binding Logout}"
								Margin="16,19,16,24"
								Grid.Row="2" />
					</Grid>
				</Grid>
			</Grid>
		</ScrollViewer>
	</Grid>
</Page>
