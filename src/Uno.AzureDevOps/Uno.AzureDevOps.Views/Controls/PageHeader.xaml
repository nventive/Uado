<controls:UadoUserControl x:Class="Uno.AzureDevOps.Views.Controls.PageHeader"
						  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
						  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
						  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
						  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
						  xmlns:cnv="using:Uno.AzureDevOps.Views.Converters"
						  xmlns:controls="using:Uno.AzureDevOps.Views.Controls"
						  xmlns:toolkit="using:Uno.UI.Toolkit"
						  x:Name="HeaderControl"
						  d:DesignHeight="115"
						  d:DesignWidth="800"
						  mc:Ignorable="d">

	<controls:UadoUserControl.Resources>
		<cnv:FromHeaderModeToValueConverter x:Key="HeaderModeToHeight"
											MinimalValue="{StaticResource CommandBarHeight}"
											LargeValue="115" />

		<cnv:FromHeaderModeToValueConverter x:Key="LargeToVisible"
											MinimalValue="Collapsed"
											LargeValue="Visible" />

		<cnv:FromHeaderModeToValueConverter x:Key="MinimalToVisible"
											MinimalValue="Visible"
											LargeValue="Collapsed" />
	</controls:UadoUserControl.Resources>

	<Grid>
		<VisualStateManager.VisualStateGroups>
			<VisualStateGroup>
				<VisualState x:Name="wide">
					<VisualState.StateTriggers>
						<AdaptiveTrigger MinWindowWidth="1024" />
					</VisualState.StateTriggers>
					<VisualState.Setters>
						<Setter Target="LargeHeaderContainer.Visibility"
								Value="Visible" />
						<Setter Target="PART_CommandBarView.Visibility"
								Value="Collapsed" />
						<Setter Target="HamburgerButton.Visibility"
								Value="Collapsed" />
					</VisualState.Setters>
				</VisualState>
			</VisualStateGroup>
		</VisualStateManager.VisualStateGroups>

		<!-- CommandBar -->
		<!--
			We use the FullscreenSideMenuBehavior to manage the visibility of
			the CommandBar based on when the side menu opens (narrow-view only)
		-->
		<CommandBar x:Name="PART_CommandBarView"
					Content="{Binding Title, ElementName=HeaderControl}">
			<CommandBar.PrimaryCommands>
				<!-- Hamburger Button -->
				<AppBarButton x:Name="HamburgerButton"
							  Style="{StaticResource BurgerMenuButtonStyle}"
							  Click="HamburgerButton_Click"
							  Visibility="{Binding HamburgerMenuVisibility, ElementName=HeaderControl}">
				</AppBarButton>
			</CommandBar.PrimaryCommands>
		</CommandBar>

		<Border x:Name="LargeHeaderContainer"
				Background="{StaticResource Color03Brush}"
				Visibility="Collapsed"
				MinHeight="{Binding Mode, ElementName=HeaderControl, Converter={StaticResource HeaderModeToHeight}}"
				toolkit:VisibleBoundsPadding.PaddingMask="Top">
			<Grid VerticalAlignment="Center"
				  Margin="0,0,112,0">

				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto" />
					<ColumnDefinition Width="*" />
				</Grid.ColumnDefinitions>

				<!-- Back Button -->
				<Button Style="{StaticResource BasicEmptyButtonStyle}"
						Command="{Binding BackCommand, ElementName=HeaderControl}"
						Visibility="{Binding Mode, ElementName=HeaderControl, Converter={StaticResource MinimalToVisible}}"
						MinHeight="40"
						MaxWidth="225"
						Margin="16,0,0,5">
					<Grid VerticalAlignment="Center">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="*" />
						</Grid.ColumnDefinitions>

						<ContentControl ContentTemplate="{StaticResource BackToIcon}" />

						<TextBlock Style="{StaticResource Typo19}"
								   FontSize="12"
								   TextWrapping="NoWrap"
								   TextTrimming="CharacterEllipsis"
								   Margin="12,0,0,0"
								   Grid.Column="1">
							<Run Text="Back to " />
							<Run Text="{Binding BackCaption, ElementName=HeaderControl}" />
						</TextBlock>
					</Grid>
				</Button>

				<Grid VerticalAlignment="Center"
					  Margin="56,0,0,0"
					  Grid.Column="1">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="Auto" />
						<ColumnDefinition Width="*" />
					</Grid.ColumnDefinitions>

					<!-- Initials -->
					<Grid Background="{StaticResource Color02Brush}"
						  CornerRadius="10"
						  Visibility="{Binding ProjectInitialsVisibility, ElementName=HeaderControl}"
						  Width="55"
						  Height="55">
						<TextBlock x:Name="Initials"
								   Text="{Binding Title, ElementName=HeaderControl, Converter={StaticResource MemberInitials}}"
								   Style="{StaticResource ProjectInitialsTextBlock}"
								   Foreground="{Binding Text, ElementName=Initials, Converter={StaticResource InitialsColor}}"
								   FontSize="24" />
					</Grid>

					<!-- Title (Large) -->
					<TextBlock Text="{Binding Title, ElementName=HeaderControl}"
							   Style="{StaticResource ProjectInitialsTextBlock}"
							   FontSize="36"
							   TextWrapping="NoWrap"
							   TextTrimming="CharacterEllipsis"
							   Visibility="{Binding Mode, ElementName=HeaderControl, Converter={StaticResource LargeToVisible}}"
							   HorizontalAlignment="Left"
							   Margin="12,0,0,0"
							   Grid.Column="1" />
				</Grid>

				<!-- Title (Minimal) -->
				<TextBlock Text="{Binding Title, ElementName=HeaderControl}"
						   Style="{StaticResource ProjectInitialsTextBlock}"
						   FontSize="16"
						   TextWrapping="NoWrap"
						   TextTrimming="CharacterEllipsis"
						   Visibility="{Binding Mode, ElementName=HeaderControl, Converter={StaticResource MinimalToVisible}}"
						   HorizontalAlignment="Center"
						   VerticalAlignment="Center"
						   Grid.ColumnSpan="2" />
			</Grid>
		</Border>
	</Grid>
</controls:UadoUserControl>
